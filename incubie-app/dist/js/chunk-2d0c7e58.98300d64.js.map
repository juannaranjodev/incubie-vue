{"version":3,"sources":["webpack:///./src/views/auth/Login.vue?3109","webpack:///src/views/auth/Login.vue","webpack:///./src/views/auth/Login.vue?5f6d","webpack:///./src/views/auth/Login.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","on","submit","$event","preventDefault","login","staticClass","attrs","value","authenticateError","type","_v","_s","_e","disabled","large","block","click","launchGoogleSignIn","src","user","size","show-score","validate-on-blur","rules","$rules","required","email","autofocus","label","model","callback","$$v","expression","password","loading","isAuthenticatePending","color","staticRenderFns","Loginvue_type_script_lang_js_","name","components","props","slug","String","default","userId","data","strategy","computed","Object","objectSpread","vuex_esm","form","id","lodash","errorOnAuthenticate","error","watch","mounted","_mounted","asyncToGenerator","regeneratorRuntime","mark","_callee","wrap","_context","prev","next","$store","dispatch","lib","action","sent","$refs","focus","stop","apply","arguments","created","destroyed","_destroyed","_callee2","_context2","clearAuthenticateError","methods","_login","_callee3","redirect","errCode","errMessage","_context3","loginForm","validate","setAuthenticatePending","authenticate","params","$route","console","log","$router","push","t0","dir","setAuthenticateError","unsetAuthenticatePending","auth_Loginvue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__"],"mappings":"uHAAA,IAAAA,EAAA,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,UAAoBE,IAAA,YAAAC,IAAoBC,OAAA,SAAAC,GAA0BA,EAAAC,iBAAwBV,EAAAW,YAAcP,EAAA,UAAeQ,YAAA,eAAyBR,EAAA,WAAgBQ,YAAA,OAAAC,OAA0BC,MAAAd,EAAAe,kBAAAC,KAAA,WAA8ChB,EAAAiB,GAAA,WAAAjB,EAAAkB,GAAAlB,EAAAe,mBAAA,YAAAf,EAAA,KAAAI,EAAA,gBAA4FQ,YAAA,qBAA+BR,EAAA,QAAaQ,YAAA,eAAyBZ,EAAAiB,GAAA,4DAAAjB,EAAAmB,KAAAf,EAAA,eAAAA,EAAA,SAA4GQ,YAAA,cAAAC,OAAiCO,SAAA,GAAAC,MAAA,GAAAC,MAAA,IAAoCf,IAAKgB,MAAA,SAAAd,GAAiD,OAAxBA,EAAAC,iBAAwBV,EAAAwB,mBAAAf,OAAwCL,EAAA,KAAAA,EAAA,OAAoBS,OAAOY,IAAA,gCAAkCzB,EAAAiB,GAAA,0CAAAb,EAAA,OAA+DQ,YAAA,kBAA4BR,EAAA,QAAAA,EAAA,QAAAJ,EAAAiB,GAAA,QAAAb,EAAA,cAAAA,EAAA,eAA0EQ,YAAA,SAAmBZ,EAAA,KAAAI,EAAA,UAA0BQ,YAAA,OAAAC,OAA0Ba,KAAA1B,EAAA0B,KAAAC,KAAA,GAAAC,cAAA,KAA8CxB,EAAA,gBAAqBS,OAAOgB,oBAAA,EAAAC,OAAA9B,EAAA+B,OAAAC,WAAAhC,EAAA+B,OAAAE,SAAAC,UAAA,GAAAlB,KAAA,QAAAmB,MAAA,SAA0HC,OAAQtB,MAAAd,EAAA,MAAAqC,SAAA,SAAAC,GAA2CtC,EAAAiC,MAAAK,GAAcC,WAAA,WAAqBnC,EAAA,gBAAqBE,IAAA,WAAAO,OAAsBgB,oBAAA,EAAAC,OAAA9B,EAAA+B,OAAAC,YAAAhB,KAAA,WAAAmB,MAAA,uBAAwGC,OAAQtB,MAAAd,EAAA,SAAAqC,SAAA,SAAAC,GAA8CtC,EAAAwC,SAAAF,GAAiBC,WAAA,eAAwB,GAAAnC,EAAA,kBAAAA,EAAA,SAAuCS,OAAO4B,QAAAzC,EAAA0C,sBAAA1B,KAAA,SAAA2B,MAAA,SAAAtB,MAAA,GAAAC,MAAA,MAA4FtB,EAAA,KAAAI,EAAA,QAAAJ,EAAAiB,GAAA,cAAAb,EAAA,QAAAJ,EAAAiB,GAAA,2BAChrD2B,6ECuGAC,GACAC,KAAA,QACAC,cACAC,OACAC,MACAjC,KAAAkC,OACAlB,UAAA,EACAmB,QAAA,MAEAC,QACApC,KAAAkC,OACAlB,UAAA,EACAmB,QAAA,OAGAE,KAfA,WAgBA,OACA3B,KAAA,KACAO,MAAA,KACAO,SAAA,KACAc,SAAA,UAGAC,SAAYC,OAAAC,EAAA,KAAAD,IACZA,OAAAE,EAAA,KAAAF,CAAA,yDACAG,KAFA,WAGA,OACAC,GAAAJ,OAAAK,EAAA,OAAAL,CAAAvD,KAAAyB,KAAA,OACAO,MAAAuB,OAAAK,EAAA,OAAAL,CAAAvD,KAAAyB,KAAA,UAAAzB,KAAAgC,MACAO,SAAAvC,KAAAuC,SACAc,SAAArD,KAAAqD,SACAL,KAAAhD,KAAAgD,OAGAlC,kBAXA,WAYA,OAAAd,KAAA6D,oBAAA7D,KAAA6D,oBAAAC,MAAA,QAGAC,SACAC,QAvCA,eAAAC,EAAAV,OAAAW,EAAA,KAAAX,CAAAY,mBAAAC,KAAA,SAAAC,IAAA,IAAAlB,EAAA1B,EAAA,OAAA0C,mBAAAG,KAAA,SAAAC,GAAA,eAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EAwCAzE,KAAA0E,OAAAC,SAAA,iBAxCA,cAAAJ,EAAAE,KAAA,EAyCAzE,KAAA0E,OAAAC,SAAA,eAzCA,UA2CAxB,EAAAnD,KAAAmD,QAEAA,EA7CA,CAAAoB,EAAAE,KAAA,gBAAAF,EAAAE,KAAA,EA8CAzE,KAAA0E,OAAAC,SAAA,aAAAxB,EAAAI,OAAAqB,EAAA,mBAAArB,EACAsB,OAAA,uBA/CA,OA8CApD,EA9CA8C,EAAAO,KAkDA9E,KAAAyB,OACAzB,KAAA+E,MAAAxC,SAAAyC,QAnDA,yBAAAT,EAAAU,SAAAZ,EAAArE,SAAA,yBAAAiE,EAAAiB,MAAAlF,KAAAmF,YAAA,GAsDAC,QAtDA,aAuDAC,UAvDA,eAAAC,EAAA/B,OAAAW,EAAA,KAAAX,CAAAY,mBAAAC,KAAA,SAAAmB,IAAA,OAAApB,mBAAAG,KAAA,SAAAkB,GAAA,eAAAA,EAAAhB,KAAAgB,EAAAf,MAAA,cAAAe,EAAAf,KAAA,EAwDAzE,KAAAyF,yBAxDA,wBAAAD,EAAAP,SAAAM,EAAAvF,SAAA,yBAAAsF,EAAAJ,MAAAlF,KAAAmF,YAAA,GA0DAO,QAAWnC,OAAAC,EAAA,KAAAD,IACXA,OAAAE,EAAA,KAAAF,CAAA,QACA,yBACA,yBACA,uBACA,6BAEAA,OAAAE,EAAA,KAAAF,CAAA,QACA,eACA,YAEA7C,MAXA,eAAAiF,EAAApC,OAAAW,EAAA,KAAAX,CAAAY,mBAAAC,KAAA,SAAAwB,IAAA,IAAAC,EAAAC,EAAAC,EAAA,OAAA5B,mBAAAG,KAAA,SAAA0B,GAAA,eAAAA,EAAAxB,KAAAwB,EAAAvB,MAAA,cAAAuB,EAAAvB,KAAA,EAYAzE,KAAAyF,yBAZA,WAcAzF,KAAA+E,MAAAkB,UAAAC,WAdA,CAAAF,EAAAvB,KAAA,gBAeAzE,KAAAmG,wBAAA,GAfAH,EAAAxB,KAAA,EAAAwB,EAAAvB,KAAA,EAmBAzE,KAAAoG,aAAApG,KAAA0D,MAnBA,WAqBA1D,KAAAgD,KArBA,CAAAgD,EAAAvB,KAAA,gBAsBAoB,GAAAhD,KAAA,YAAAwD,QAAArD,KAAAhD,KAAAgD,OAtBAgD,EAAAvB,KAAA,GAuBAzE,KAAA0E,OAAAC,SAAA,oBAvBA,QAAAqB,EAAAvB,KAAA,iBAyBAoB,EAAAtC,OAAAK,EAAA,OAAAL,CAAAvD,KAAAsG,OAAA,oBAAAzD,KAAA,QAzBA,QA4BA0D,QAAAC,IAAA,aAAAX,GAEA7F,KAAAyG,QAAAC,KAAAb,GA9BAG,EAAAvB,KAAA,oBAAAuB,EAAAxB,KAAA,GAAAwB,EAAAW,GAAAX,EAAA,YAgCAF,EAAAvC,OAAAK,EAAA,OAAAL,CAAAyC,EAAAW,GAAA,QACAZ,EAAAxC,OAAAK,EAAA,OAAAL,CAAAyC,EAAAW,GAAA,wBACAJ,QAAAK,IAAAZ,EAAAW,IACA,MAAAb,EAnCA,CAAAE,EAAAvB,KAAA,SAoCAzE,KAAAyG,QAAAC,MAAA7D,KAAA,iBApCAmD,EAAAvB,KAAA,wBAAAuB,EAAAvB,KAAA,GAsCAzE,KAAA6G,sBAAA/C,MAAAiC,IAtCA,QA0CA/F,KAAA8G,2BA1CA,yBAAAd,EAAAf,SAAAW,EAAA5F,OAAA,oCAAA2F,EAAAT,MAAAlF,KAAAmF,YAAA,MClK8V4B,EAAA,cCO9VC,EAAgBzD,OAAA0D,EAAA,KAAA1D,CACdwD,EACAjH,EACA6C,GACF,EACA,KACA,KACA,MAIAqE,EAAAE,QAAAC,OAAA,YACeC,EAAA,WAAAJ","file":"js/chunk-2d0c7e58.98300d64.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-form',{ref:\"loginForm\",on:{\"submit\":function($event){$event.preventDefault();_vm.login()}}},[_c('v-card',{staticClass:\"auth__card\"},[_c('v-alert',{staticClass:\"mb-2\",attrs:{\"value\":_vm.authenticateError,\"type\":\"error\"}},[_vm._v(\"\\n      \"+_vm._s(_vm.authenticateError)+\"\\n    \")]),(_vm.user)?_c('v-card-title',{staticClass:\"auth__title pt-4\"},[_c('span',{staticClass:\"subheading\"},[_vm._v(\"\\n        To continue, first verify it's you\\n      \")])]):_vm._e(),_c('v-card-text',[_c('v-btn',{staticClass:\"btn__social\",attrs:{\"disabled\":\"\",\"large\":\"\",\"block\":\"\"},on:{\"click\":function($event){$event.preventDefault();return _vm.launchGoogleSignIn($event)}}},[_c('i',[_c('img',{attrs:{\"src\":\"/images/icons/google.svg\"}})]),_vm._v(\"\\n        Log In with Google\\n      \")]),_c('div',{staticClass:\"auth__divider\"},[_c('span'),_c('span',[_vm._v(\"or\")]),_c('span')])],1),_c('v-card-text',{staticClass:\"py-0\"},[(_vm.user)?_c('i-user',{staticClass:\"mb-3\",attrs:{\"user\":_vm.user,\"size\":30,\"show-score\":false}}):_c('v-text-field',{attrs:{\"validate-on-blur\":true,\"rules\":[_vm.$rules.required(), _vm.$rules.email()],\"autofocus\":\"\",\"type\":\"email\",\"label\":\"Email\"},model:{value:(_vm.email),callback:function ($$v) {_vm.email=$$v},expression:\"email\"}}),_c('v-text-field',{ref:\"password\",attrs:{\"validate-on-blur\":true,\"rules\":[_vm.$rules.required()],\"type\":\"password\",\"label\":\"Enter your password\"},model:{value:(_vm.password),callback:function ($$v) {_vm.password=$$v},expression:\"password\"}})],1),_c('v-card-actions',[_c('v-btn',{attrs:{\"loading\":_vm.isAuthenticatePending,\"type\":\"submit\",\"color\":\"accent\",\"large\":\"\",\"block\":\"\"}},[(_vm.user)?_c('span',[_vm._v(\"Continue\")]):_c('span',[_vm._v(\"Log In\")])])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-form\n    ref=\"loginForm\"\n    @submit.prevent=\"login()\">\n    <v-card class=\"auth__card\">\n      <v-alert\n        :value=\"authenticateError\"\n        class=\"mb-2\"\n        type=\"error\">\n        {{ authenticateError }}\n      </v-alert>\n\n      <v-card-title\n        v-if=\"user\"\n        class=\"auth__title pt-4\">\n        <span class=\"subheading\">\n          To continue, first verify it's you\n        </span>\n      </v-card-title>\n      <v-card-text>\n        <v-btn\n          class=\"btn__social\"\n          disabled\n          large\n          block\n          @click.prevent=\"launchGoogleSignIn\">\n          <i>\n            <img src=\"/images/icons/google.svg\">\n          </i>\n          Log In with Google\n        </v-btn>\n\n        <!--\n        <v-btn\n          class=\"btn__social\"\n          large\n          disabled>\n          <i>\n            <img src=\"/images/icons/linkedin.svg\">\n          </i>\n          Log In with Linked In\n        </v-btn>\n\n        <v-btn\n          class=\"btn__social\"\n          large\n          disabled>\n          <i>\n            <img src=\"/images/icons/facebook.svg\">\n          </i>\n          Log In with Facebook\n        </v-btn>\n        -->\n\n        <div class=\"auth__divider\">\n          <span/>\n          <span>or</span>\n          <span/>\n        </div>\n      </v-card-text>\n\n      <v-card-text class=\"py-0\">\n        <i-user\n          v-if=\"user\"\n          :user=\"user\"\n          :size=\"30\"\n          :show-score=\"false\"\n          class=\"mb-3\"/>\n        <v-text-field\n          v-else\n          v-model=\"email\"\n          :validate-on-blur=\"true\"\n          :rules=\"[$rules.required(), $rules.email()]\"\n          autofocus\n          type=\"email\"\n          label=\"Email\"/>\n        <v-text-field\n          ref=\"password\"\n          v-model=\"password\"\n          :validate-on-blur=\"true\"\n          :rules=\"[$rules.required()]\"\n          type=\"password\"\n          label=\"Enter your password\"/>\n      </v-card-text>\n      <v-card-actions>\n        <v-btn\n          :loading=\"isAuthenticatePending\"\n          type=\"submit\"\n          color=\"accent\"\n          large\n          block>\n          <span v-if=\"user\">Continue</span>\n          <span v-else>Log In</span>\n        </v-btn>\n      </v-card-actions>\n    </v-card>\n  </v-form>\n</template>\n\n<script>\nimport { mapActions, mapMutations, mapState } from 'vuex'\nimport { get } from 'lodash'\nimport { paramsForServer } from 'feathers-hooks-common'\n\nexport default {\n  name: 'Login',\n  components: {},\n  props: {\n    slug: {\n      type: String,\n      required: false,\n      default: null\n    },\n    userId: {\n      type: String,\n      required: false,\n      default: null\n    }\n  },\n  data () {\n    return {\n      user: null,\n      email: null,\n      password: null,\n      strategy: 'local'\n    }\n  },\n  computed: {\n    ...mapState('auth', ['isAuthenticatePending', 'errorOnAuthenticate']),\n    form () {\n      return {\n        id: get(this.user, '_id'),\n        email: get(this.user, 'email') || this.email,\n        password: this.password,\n        strategy: this.strategy,\n        slug: this.slug\n      }\n    },\n    authenticateError () {\n      return this.errorOnAuthenticate ? this.errorOnAuthenticate.error : null\n    }\n  },\n  watch: {},\n  async mounted () {\n    await this.$store.dispatch('auth/clearAll')\n    await this.$store.dispatch('auth/logout')\n\n    const userId = this.userId\n\n    if (userId) {\n      const user = await this.$store.dispatch('users/get', [userId, paramsForServer({\n        action: 'getPublicProfile'\n      })])\n\n      this.user = user\n      this.$refs.password.focus()\n    }\n  },\n  created () {},\n  async destroyed () {\n    await this.clearAuthenticateError()\n  },\n  methods: {\n    ...mapMutations('auth', [\n      'clearAuthenticateError',\n      'setAuthenticatePending',\n      'setAuthenticateError',\n      'unsetAuthenticatePending'\n    ]),\n    ...mapActions('auth', [\n      'authenticate',\n      'logout'\n    ]),\n    async login () {\n      await this.clearAuthenticateError();\n\n      if (this.$refs.loginForm.validate()) {\n        this.setAuthenticatePending(true);\n\n        try {\n          let redirect;\n          await this.authenticate(this.form);\n\n          if (this.slug) {\n            redirect = { name: 'feed/main', params: { slug: this.slug } }\n            await this.$store.dispatch(\"worker/subscribe\");\n          } else {\n            redirect = get(this.$route, 'query.redirect') || { name: 'root' }\n          }\n\n            console.log(\"redirect: \", redirect);\n\n          this.$router.push(redirect)\n        } catch (err) {\n          const errCode = get(err, 'code')\n          const errMessage = get(err, 'data.message', 'error')\n          console.dir(err)\n          if (errCode === 403) {\n            this.$router.push({ name: 'unauthorized' })\n          } else {\n            await this.setAuthenticateError({ error: errMessage })\n          }\n        }\n\n        this.unsetAuthenticatePending()\n      }\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=deab7dc8&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"Login.vue\"\nexport default component.exports"],"sourceRoot":""}