(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-96094d52"],{"0070":function(e,t,r){"use strict";var a=r("3fcb"),n=r.n(a);n.a},"27a6":function(e,t,r){},"2e2f":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("board-create-dialog"),r("board-slack-settings"),r("v-flex",{attrs:{xs12:"",sm8:"",lg6:""}},[r("v-container",{staticClass:"fluid grid-list-md"},[r("v-layout",{attrs:{column:"","fill-height":""}},[r("v-flex",[r("v-card",{staticClass:"px-4 pt-4"},[r("i-media",[e.board.image?r("i-board-icon",{attrs:{slot:"figure",board:e.board,size:154},slot:"figure"}):r("button",{staticClass:"board__settings__upload-image",attrs:{slot:"figure"},slot:"figure"},[r("h2",{staticClass:"headline"},[e._v("Upload Image")])]),r("h1",{staticClass:"heading"},[e._v(e._s(e.board.name))]),r("div",[e._v("\n                Created by\n                "+e._s(e.board.owner.firstName)+"\n                "+e._s(e.board.owner.lastName)+"\n              ")]),r("div",[e._v("\n                "+e._s(e.board.description)+"\n              ")])],1),r("v-list-tile",[r("v-layout",{attrs:{"justify-end":""}},[r("v-btn",{attrs:{flat:"",icon:""},on:{click:e.boardUpdate}},[r("v-icon",[e._v("edit")])],1)],1)],1)],1),r("div",{staticClass:"my-4"},[e.currentBoard&&e.isAdmin(e.loggedInUser,e.currentBoard._id)?r("v-card",[r("v-list-tile",[r("v-switch",{attrs:{color:"indigo",label:"Hide vote count"},on:{change:e.changeHideVote},model:{value:e.currentBoard.hideVote,callback:function(t){e.$set(e.currentBoard,"hideVote",t)},expression:"currentBoard.hideVote"}})],1)],1):e._e()],1),r("v-list",{attrs:{subheader:""}},[r("v-subheader",[e._v("Integrations")]),e._l(e.items,function(t){return[r("v-list-tile",{key:t.title,attrs:{avatar:""}},[r("v-list-tile-avatar",[r("img",{attrs:{src:t.avatar}})]),e.checkBoardAdmin?r("v-list-tile-content",[r("v-list-tile-title",[r("b",[e._v(e._s(t.title))]),e._v(" "+e._s(t.active&&e.currentBoard&&"#"!=e.currentBoard.slackBoardId?"   Connected to Channel "+e.currentBoard.slackBoardId:"")+"\n                  ")])],1):e._e(),e.checkBoardAdmin?r("v-list-tile-action",[r("v-list-tile",[r("v-btn",{attrs:{flat:"",icon:"",disabled:!t.active},on:{click:function(r){e.editIntegration(t.title)}}},[r("v-icon",[e._v("edit")])],1),r("v-switch",{staticClass:"pl-4",attrs:{color:"indigo",label:""},on:{change:function(r){e.integrateTo(t)}},model:{value:t.active,callback:function(r){e.$set(t,"active",r)},expression:"item.active"}})],1)],1):e._e()],1)]})],2)],1)],1)],1)],1)],1)},n=[],i=(r("96cf"),r("3040")),s=(r("7f7f"),r("c93e")),o=r("2f62"),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{value:e.isOpen,width:"440",lazy:""},on:{input:e.setOpen}},[r("v-form",{ref:"createBoardForm",on:{submit:function(t){return t.preventDefault(),e.createBoard(t)}}},[r("v-card",[r("v-alert",{staticClass:"mb-4",attrs:{value:e.errorOnCreate,type:"error"}},[e.errorOnCreate?r("ul",{staticClass:"u__flat-list"},e._l(e.errorOnCreate.errors,function(t,a){return r("li",{key:a},[e._v("\n            "+e._s(t)+"\n          ")])})):e._e()]),r("v-card-title",{attrs:{"primary-title":""}},[r("h3",{staticClass:"title"},[e._v("Create Board")])]),r("v-card-text",[r("v-text-field",{ref:"name",attrs:{rules:[e.$rules.required()],"error-messages":e.nameErrors,placeholder:"Board Name"},on:{blur:e.handleBoardNameBlur},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),r("v-text-field",{attrs:{placeholder:"Description"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),r("v-flex",{attrs:{xs12:""}},[r("v-combobox",{attrs:{outline:"","hide-selected":"",items:e.items,label:"Collaborators",multiple:"",color:"primary",chips:""},scopedSlots:e._u([{key:"selection",fn:function(t){return[r("v-chip",{key:JSON.stringify(t.item),staticClass:"v-chip--select-multi",attrs:{color:"blue",selected:t.selected,disabled:t.disabled,close:""},on:{input:function(e){t.parent.selectItem(t.item)}}},[r("v-avatar",{staticClass:"accent white--text",domProps:{textContent:e._s(t.item.slice(0,2).toUpperCase())}}),e._v("\n            "+e._s(t.item)+"\n          ")],1)]}}]),model:{value:e.select,callback:function(t){e.select=t},expression:"select"}})],1)],1),r("v-card-actions",{staticClass:"justify-end"},[r("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(t){return t.stopPropagation(),e.close(t)}}},[e._v("Cancel\n        ")]),r("v-btn",{attrs:{type:"submit",color:"accent",flat:""}},[e._v("Create\n        ")])],1)],1)],1)],1)},l=[],d=(r("ac6a"),r("a481"),r("64ae")),u=r.n(d),h=r("2ef0"),p={name:"DialogueCreateBoard",data:function(){return{name:null,description:null,error:null,slug:null,select:null,items:[],newBoardId:0}},computed:Object(s["a"])({},Object(o["e"])("auth",["actionTypes"]),Object(o["e"])("ui",{isOpen:"isCreateBoardDialogOpen"}),Object(o["e"])("boards",["errorOnCreate"]),Object(o["e"])("boardManagement",["errors"]),Object(o["c"])("auth",["loggedInUser"]),Object(o["c"])("auth",["allUsers"]),Object(o["c"])("boardManagement",["nameErrors","hasErrors"]),Object(o["c"])("companies",{company:"current"}),Object(o["c"])("boards",{board:"current"}),{newBoard:function(){return{name:this.name,description:this.description,slug:this.slug||u.a.lowerCase(this.name.replace(/ /g,"")),company:this.company._id,createdBy:this.loggedInUser._id}}}),watch:{isOpen:{immediate:!0,handler:function(e){var t=this;e&&this.$nextTick(function(){t.$refs.name&&t.$refs.name.focus()})}}},mounted:function(){this.getItems()},methods:Object(s["a"])({},Object(o["d"])("ui",{setOpen:"setCreateBoardDialogOpen"}),Object(o["d"])("boards",{addBoard:"addItem",setCurrentBoard:"setCurrent"}),Object(o["b"])("boards",["create"]),Object(o["b"])("boardManagement",["checkUnique"]),{handleBoardNameBlur:function(){this.name&&this.checkUnique(this.newBoard)},close:function(){this.setOpen(!1),this.$router.push({name:"feed/main"})},createBoard:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$refs.createBoardForm,console.log("ruby test combobox :",this.select),!t.validate()||this.hasErrors){e.next=20;break}return e.prev=3,e.next=6,this.$dispatchAction({type:this.$actionTypes.CREATE_BOARD,entity:this.company._id,payload:this.newBoard});case 6:r=e.sent,a=Object(h["get"])(r,"data.board.slug"),console.log("ruby: boardSlug = ",a),this.newBoardId=r.data.board._id,console.log("ruby test :",r.data.board._id),this.inviteBoardMembers(),t.reset(),this.setOpen(!1),this.$router.push({name:"board/main",params:{boardSlug:a}}),e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](3),console.log("ruby: test here is error");case 20:case"end":return e.stop()}},e,this,[[3,17]])}));return function(){return e.apply(this,arguments)}}(),getItems:function(){var e=this;console.log("ruby test users = ",this.allUsers.data),this.items=[],this.allUsers.data.forEach(function(t){e.items.push(t.firstName+" "+t.lastName)})},validateEmail:function(e){var t=/\S+@\S+\.\S+/;return t.test(e)},inviteBoardMembers:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("ruby test ***** invite board members **** in boardCreateDialog"),t=this.invitations(),!t){e.next=8;break}return console.log("ruby: test send invite email"),e.next=6,this.$dispatchAction({type:this.$actionTypes.INVITE_COMPANY_MEMBERS,entity:this.company._id,payload:t});case 6:return e.next=8,this.$dispatchAction({type:this.$actionTypes.INVITE_BOARD_MEMBERS,entity:this.company._id,payload:t});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getUserWithName:function(e){var t=0;for(t=0;t<this.allUsers.data.length;t++){var r=this.allUsers.data[t],a=r.firstName+" "+r.lastName;if(e==a)return console.log("fullName 's email = "+r.email),r}return console.log("Not found in Users"),null},getUserWithEmail:function(e){var t=0;for(t=0;t<this.allUsers.data.length;t++){var r=this.allUsers.data[t];if(e==r.email)return console.log("ruby: His 's name = "+r.firstName),r}return console.log("Not found in Users"),null},invitations:function(){var e=[],t="",r=0,a=0;if(!this.select)return e;for(a=0;a<this.select.length;a++){var n=this.select[a];if(t="",this.validateEmail(n)){t=n;var i=this.getUserWithEmail(t);r=i?i._id:-1}else{var s=this.getUserWithName(n);r=-1,s?(t=s.email,r=s._id):t=""}console.log("ruby: after check email = ",t,"user = ",r),""!=t&&e.push({email:t,role:"member",company:this.company._id,invitedBy:this.loggedInUser._id,board:this.newBoardId})}return e}})},m=p,b=r("2877"),g=Object(b["a"])(m,c,l,!1,null,null,null);g.options.__file="BoardCreateDialog.vue";var v=g.exports,f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{value:e.isOpen,width:"440",lazy:""},on:{input:e.setOpen}},[r("v-form",{ref:"slackSettingForm",on:{submit:function(t){return t.preventDefault(),e.saveSettings(t)}}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[r("h3",{staticClass:"title"},[e._v("Slack Integration")])]),r("v-card-text",[e.checkCompanyAdmin?r("v-text-field",{attrs:{label:"ApiToken",placeholder:"xxxx-xxxxx-xxxxx-xxxxxxxx",outline:""},model:{value:e.apiToken,callback:function(t){e.apiToken=t},expression:"apiToken"}}):r("p",[e._v(e._s(e.company&&e.company.slackIntegration?"":"Your Company Admin has not setup Slack yet"))]),r("v-text-field",{attrs:{label:"Channel",placeholder:"#incubie",outline:""},model:{value:e.slackChannel,callback:function(t){e.slackChannel=t},expression:"slackChannel"}}),r("h3",[e._v("Post to Slack When")]),r("v-list-tile",[r("v-checkbox",{attrs:{color:"indigo",label:"New Idea is Posted"},model:{value:e.checkbox1,callback:function(t){e.checkbox1=t},expression:"checkbox1"}})],1),r("v-list-tile",[r("v-checkbox",{attrs:{color:"indigo",label:"New Comment is Added"},model:{value:e.checkbox2,callback:function(t){e.checkbox2=t},expression:"checkbox2"}})],1),r("v-list-tile",[r("v-checkbox",{attrs:{color:"indigo",label:"Idea Changes State"},model:{value:e.checkbox3,callback:function(t){e.checkbox3=t},expression:"checkbox3"}})],1),r("v-list-tile",[r("v-checkbox",{attrs:{color:"indigo",label:"When a New Member Joins"},model:{value:e.checkbox4,callback:function(t){e.checkbox4=t},expression:"checkbox4"}})],1)],1),r("v-card-actions",{staticClass:"justify-end"},[r("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(t){return t.stopPropagation(),e.close(t)}}},[e._v("Cancel\n        ")]),r("v-btn",{attrs:{type:"submit",color:"accent",loading:e.isUpdatePending,flat:""}},[e._v("Save\n        ")])],1)],1)],1)],1)},k=[],B={name:"BoardSlackSettings",data:function(){return{isUpdatePending:!1,checkbox1:!1,checkbox2:!1,checkbox3:!1,checkbox4:!1,slackChannel:null,apiToken:null}},computed:Object(s["a"])({},Object(o["e"])("ui",{isOpen:"isBoardSlackSettingsOpen"}),Object(o["c"])("auth",["loggedInUser"]),Object(o["c"])("companies",{company:"current"}),Object(o["c"])("boards",{currentBoard:"current"}),Object(o["c"])("users",{isAdmin:"isAdmin"}),{checkCompanyAdmin:function(){return!!(this.currentBoard&&this.loggedInUser&&this.isAdmin(this.loggedInUser,this.currentBoard.company))&&(console.log("ruby: user ",this.loggedInUser," company",this.currentBoard.company),!0)}}),watch:{isOpen:function(e){e&&(console.log("ruby: test : BoardSlackSetting Dialog opened"),this.currentBoard&&(this.slackChannel=this.currentBoard.slackBoardId,this.checkbox1=this.currentBoard.messageOnIdeaCreation,this.checkbox2=this.currentBoard.messageOnCommentCreation,this.checkbox3=this.currentBoard.messageOnIdeaStatusChanged,this.checkbox4=this.currentBoard.messageOnJoinBoard))}},mounted:function(){},methods:Object(s["a"])({},Object(o["d"])("ui",{setOpen:"setBoardSlackSettingsOpen"}),Object(o["b"])("boards",{patchBoard:"patch"}),{close:function(){this.setOpen(!1)},saveSettings:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.isUpdatePending=!0,e.next=3,this.patchBoard([this.currentBoard._id,{slackBoardId:this.slackChannel,messageOnIdeaCreation:this.checkbox1,messageOnCommentCreation:this.checkbox2,messageOnIdeaStatusChanged:this.checkbox3,messageOnJoinBoard:this.checkbox4}]);case 3:if(!this.checkCompanyAdmin){e.next=8;break}if(!this.apiToken||""==this.apiToken){e.next=8;break}return console.log("ruby: test API TOKEN",this.apiToken),e.next=8,this.$dispatchAction({type:this.$actionTypes.UPDATE_SLACK_TOKEN,payload:{token:this.apiToken,company:this.currentBoard.company},entity:this.currentBoard.company});case 8:this.setOpen(!1),this.isUpdatePending=!1;case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()})},x=B,y=(r("74b2"),Object(b["a"])(x,f,k,!1,null,"1a9a665c",null));y.options.__file="BoardSlackSettings.vue";var O=y.exports,_={name:"BoardSettings",components:{BoardCreateDialog:v,BoardSlackSettings:O},props:{boardSlug:{type:String,default:void 0}},data:function(){return{items:[{active:!0,title:"Slack",avatar:"/images/icons/slack.png"}],hideFromGuest:!1}},computed:Object(s["a"])({},Object(o["e"])("boards",{isCreateDialogOpen:"isCreateBoardDialogOpen"}),Object(o["c"])("auth",["loggedInUser"]),Object(o["c"])("boards",{findBoards:"find",currentBoard:"current"}),Object(o["c"])("users",{isAdmin:"isAdmin"}),{board:function(){return{name:this.currentBoard?this.currentBoard.name:"New Project",description:this.currentBoard?this.currentBoard.description:"",image:this.currentBoard?this.currentBoard.image:null,owner:this.loggedInUser,hideVote:this.currentBoard?this.currentBoard.hideVote:0}}},Object(o["c"])("users",{isAdmin:"isAdmin"}),{checkBoardAdmin:function(){return!!(this.loggedInUser&&this.currentBoard&&this.isAdmin(this.loggedInUser,this.currentBoard._id))}}),watch:{"$route.params.boardSlug":{immediate:!0,handler:function(e){e?(console.log("ruby: MUST BE ERROR - : setCreateBoardDialogOpen",e),this.setCurrentBoardBySlug(e)):(console.log("ruby: MUST BE ERROR: setCreateBoardDialogOpen"),this.setCreateBoardDialogOpen())}},currentBoard:{immediate:!0,handler:function(e){this.mutableBoard={name:e?e.name:null,description:e?e.description:null,createdDate:e?e.createdDate:null,image:e?e.image:null}}}},methods:Object(s["a"])({},Object(o["b"])("boards",{setCurrentBoardBySlug:"setCurrentBySlug"}),Object(o["d"])("ui",["setCreateBoardDialogOpen","setBoardSlackSettingsOpen"]),{changeHideFromGuest:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("ruby test Hide From Guest :",this.hideFromGuest);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),changeHideVote:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("ruby test Hide Vote :",this.currentBoard.hideVote),t=this.isAdmin(this.loggedInUser,this.currentBoard._id),t){e.next=5;break}return console.log("ruby: not Admin"),e.abrupt("return");case 5:return e.next=7,this.$dispatchAction({type:this.$actionTypes.HIDE_VOTE_COUNT,entity:this.currentBoard._id,user:this.loggedInUser._id,payload:{value:this.currentBoard.hideVote,board:this.currentBoard._id}});case 7:r=e.sent,console.log("ruby: response ",r);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),boardUpdate:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("ruby: board update"),this.$router.push({name:"board/update",params:{boardSlug:this.currentBoard.slug}});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),integrateTo:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("ruby: integrateTo clicked ",t.title),t.active){e.next=3;break}return e.abrupt("return");case 3:e.t0=t.title,e.next="Slack"===e.t0?6:"Jira"===e.t0?8:9;break;case 6:return this.setBoardSlackSettingsOpen(!0),e.abrupt("break",9);case 8:return e.abrupt("break",9);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),editIntegration:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("ruby: editIntegration clicked ",t),e.t0=t,e.next="Slack"===e.t0?4:"Jira"===e.t0?6:7;break;case 4:return this.setBoardSlackSettingsOpen(!0),e.abrupt("break",7);case 6:return e.abrupt("break",7);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()})},C=_,w=(r("0070"),Object(b["a"])(C,a,n,!1,null,"b2461d1a",null));w.options.__file="BoardSettings.vue";t["default"]=w.exports},"3fcb":function(e,t,r){},"74b2":function(e,t,r){"use strict";var a=r("27a6"),n=r.n(a);n.a}}]);
//# sourceMappingURL=chunk-96094d52.28eb016b.js.map