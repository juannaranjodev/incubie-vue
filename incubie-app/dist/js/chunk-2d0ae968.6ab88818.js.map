{"version":3,"sources":["webpack:///./src/views/account/AccountPassword.vue?6730","webpack:///src/views/account/AccountPassword.vue","webpack:///./src/views/account/AccountPassword.vue?ea17","webpack:///./src/views/account/AccountPassword.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","small","on","submit","$event","preventDefault","updatePassword","wrap","xs12","label","color","rules","$rules","required","type","model","value","callback","$$v","oldPassword","expression","newPassword","confirmPassword","loading","isUpdatePending","flat","_v","staticRenderFns","AccountPasswordvue_type_script_lang_js_","name","components","props","data","mutableUser","computed","Object","objectSpread","vuex_esm","company","watch","loggedInUser","immediate","handler","user","password","created","methods","patchUser","showSnackbar","_updatePassword","asyncToGenerator","regeneratorRuntime","mark","_callee","compareRes","_context","prev","next","console","log","bcrypt_default","a","compareSync","message","abrupt","_id","stop","apply","arguments","account_AccountPasswordvue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__"],"mappings":"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","file":"js/chunk-2d0ae968.6ab88818.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('i-container',{staticClass:\"i-account\",attrs:{\"small\":\"\"}},[_c('v-card',{staticClass:\"mb-5\"},[_c('v-form',{on:{\"submit\":function($event){$event.preventDefault();return _vm.updatePassword($event)}}},[_c('v-card-text',[_c('v-layout',{attrs:{\"wrap\":\"\"}},[_c('v-flex',{attrs:{\"xs12\":\"\"}},[_c('v-text-field',{attrs:{\"label\":\"Old Password\",\"color\":\"accent\",\"rules\":[_vm.$rules.required()],\"type\":\"password\"},model:{value:(_vm.oldPassword),callback:function ($$v) {_vm.oldPassword=$$v},expression:\"oldPassword\"}})],1),_c('v-flex',{attrs:{\"xs12\":\"\"}},[_c('v-text-field',{attrs:{\"label\":\"New Password\",\"color\":\"accent\",\"rules\":[_vm.$rules.required()],\"type\":\"password\"},model:{value:(_vm.newPassword),callback:function ($$v) {_vm.newPassword=$$v},expression:\"newPassword\"}})],1),_c('v-flex',{attrs:{\"xs12\":\"\"}},[_c('v-text-field',{attrs:{\"label\":\"Confirm Password\",\"color\":\"accent\",\"rules\":[_vm.$rules.required()],\"type\":\"password\"},model:{value:(_vm.confirmPassword),callback:function ($$v) {_vm.confirmPassword=$$v},expression:\"confirmPassword\"}})],1)],1)],1),_c('v-card-actions',{staticClass:\"justify-end\"},[_c('v-btn',{attrs:{\"loading\":_vm.isUpdatePending,\"type\":\"submit\",\"color\":\"accent\",\"flat\":\"\"}},[_vm._v(\"\\n          Change\\n        \")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <i-container\n    small\n    class=\"i-account\">\n    <v-card class=\"mb-5\">\n      <v-form @submit.prevent=\"updatePassword\">\n        <v-card-text>\n          <v-layout wrap>\n            <v-flex xs12>\n              <v-text-field\n                v-model=\"oldPassword\"\n                label=\"Old Password\"\n                color=\"accent\"\n                :rules=\"[$rules.required()]\"\n                type=\"password\"/>\n            </v-flex>\n            <v-flex xs12>\n              <v-text-field\n                v-model=\"newPassword\"\n                label=\"New Password\"\n                color=\"accent\"\n                :rules=\"[$rules.required()]\"\n                type=\"password\"/>\n            </v-flex>\n            <v-flex xs12>\n              <v-text-field\n                v-model=\"confirmPassword\"\n                label=\"Confirm Password\"\n                color=\"accent\"\n                :rules=\"[$rules.required()]\"\n                type=\"password\"/>\n            </v-flex>\n          </v-layout>\n        </v-card-text>\n        <v-card-actions\n          class=\"justify-end\">\n          <v-btn\n            :loading=\"isUpdatePending\"\n            type=\"submit\"\n            color=\"accent\"\n            flat>\n            Change\n          </v-btn>\n        </v-card-actions>\n      </v-form>\n    </v-card>\n  </i-container>\n</template>\n\n<script>\n// ruby test import\nimport { mapActions, mapGetters, mapMutations } from 'vuex'\nimport { get } from 'lodash'\nimport bcrypt from 'bcryptjs'\n\nexport default {\n  name: 'AccountPassword',\n  components: {},\n  props: {},\n  data () {\n    return {\n      isUpdatePending: false,\n      // ruby test <\n      oldPassword: '',\n      newPassword: '',\n      confirmPassword: '',\n      mutableUser: null,\n      // ruby test >\n    }\n  },\n  computed: {\n    ...mapGetters('auth', ['loggedInUser']),\n    ...mapGetters('companies', {\n      company: 'current'\n    }),\n  },\n\n  // ruby test <\n  watch: {\n    loggedInUser: {\n      immediate: true,\n      handler (user) {\n        this.mutableUser = {\n          password: user.password,\n        }\n      }\n    }\n  },\n  // ruby test >\n  created () {},\n  methods: {\n    // ruby test <\n    ...mapActions('users', {\n      patchUser: 'patch'\n    }),\n    ...mapMutations('snackbar', {\n      showSnackbar: 'show'\n    }),\n\n    async updatePassword () {\n      console.log('ruby: update password : ', this.oldPassword);\n      let compareRes = bcrypt.compareSync(this.oldPassword, this.loggedInUser.password);\n      console.log('ruby: **** ', compareRes);\n      this.isUpdatePending = true;\n\n      console.log(\"new = \",this.newPassword, \" , \" , this.confirmPassword);\n      if(this.confirmPassword != this.newPassword ||  !compareRes) {\n        this.showSnackbar({ color:'error', message: 'Password is incorrect.' });\n        this.isUpdatePending = false;\n        return;\n      }\n\n      this.mutableUser.password = this.newPassword\n      await this.patchUser([this.loggedInUser._id, this.mutableUser])\n\n      this.isUpdatePending = false;\n      this.showSnackbar({ color:'success', message: 'Password updated' })\n    }\n    // ruby test >\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AccountPassword.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AccountPassword.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AccountPassword.vue?vue&type=template&id=276a4e28&\"\nimport script from \"./AccountPassword.vue?vue&type=script&lang=js&\"\nexport * from \"./AccountPassword.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"AccountPassword.vue\"\nexport default component.exports"],"sourceRoot":""}