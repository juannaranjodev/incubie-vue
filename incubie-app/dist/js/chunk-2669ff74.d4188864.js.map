{"version":3,"sources":["webpack:///./src/views/company/CompanyBilling.vue?4484","webpack:///./src/views/company/CompanyBilling.vue?0c35","webpack:///src/views/company/CompanyBilling.vue","webpack:///./src/views/company/CompanyBilling.vue?3132","webpack:///./src/views/company/CompanyBilling.vue"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_CompanyBilling_vue_vue_type_style_index_0_id_112bc8f2_lang_stylus_scoped_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_CompanyBilling_vue_vue_type_style_index_0_id_112bc8f2_lang_stylus_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","this","_h","$createElement","_c","_self","attrs","grid-list-md","column","xs12","sm9","md5","staticClass","_v","_s","loggedInUser","stripe","plan","activeUsers","headcount","to","color","cardBrand","cardLast4","flat","on","click","setPayInfo","_l","invoice","key","id","row","space-between","amount","created","source","last4","staticRenderFns","planData","constants","CompanyBillingvue_type_script_lang_js_","name","components","data","invoices","computed","Object","objectSpread","vuex_esm","company","mounted","getInvoices","methods","showSnackbar","_this","$checkout","open","panelLabel","currency","token","_token","changePayment","incubiePremium","closed","console","log","message","specificPlan","_this2","$dispatchAction","type","$actionTypes","SET_PAYMENT_INFO","entity","_id","payload","userId","then","res","success","customer","card","sources","brand","_this3","GET_PAYMENT_INFO","forEach","timestamp","parseInt","d","Date","month","getMonth","day","getDate","year","getFullYear","length","join","getActiveUserCount","company_CompanyBillingvue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__"],"mappings":"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","file":"js/chunk-2669ff74.d4188864.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CompanyBilling.vue?vue&type=style&index=0&id=112bc8f2&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CompanyBilling.vue?vue&type=style&index=0&id=112bc8f2&lang=stylus&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{attrs:{\"grid-list-md\":\"\"}},[_c('v-layout',{attrs:{\"column\":\"\"}},[_c('v-flex',{attrs:{\"xs12\":\"\",\"sm9\":\"\",\"md5\":\"\"}},[_c('v-card',[_c('v-card-title',[_c('p',{staticClass:\"caption\"},[_vm._v(\"Your Plan\")])]),_c('v-card-text',[_c('p',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.loggedInUser.stripe.plan))]),_c('p',{staticClass:\"caption\"},[_vm._v(\" Active Users: \"+_vm._s(_vm.activeUsers)+\" / \"+_vm._s(_vm.headcount)+\" \")])]),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{attrs:{\"to\":\"company.users\",\"color\":\"accent\"}},[_vm._v(\"\\n            Add Users\\n          \")])],1)],1)],1),_c('v-flex',{attrs:{\"xs12\":\"\",\"sm9\":\"\",\"md5\":\"\"}},[_c('v-card',[_c('v-card-title',[_c('p',{staticClass:\"caption\"},[_vm._v(\"Payment Method\")])]),_c('v-card-text',{staticClass:\"mt-0\"},[_c('p',{staticClass:\"title\"},[_vm._v(\" \"+_vm._s(this.cardBrand)+\" Ending in \"+_vm._s(this.cardLast4)+\" \")])]),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{attrs:{\"flat\":\"\"},on:{\"click\":_vm.setPayInfo}},[_vm._v(\"\\n            Change Payment\\n          \")])],1)],1)],1),_c('v-flex',{attrs:{\"xs12\":\"\",\"sm9\":\"\",\"md5\":\"\"}},[_c('v-card',[_c('v-card-title',[_c('p',{staticClass:\"caption\"},[_vm._v(\"Recent Payments\")])]),_c('v-card-text',_vm._l((_vm.invoices),function(invoice){return _c('v-list',{key:invoice.id},[_c('v-list-tile',[_c('v-layout',{attrs:{\"row\":\"\",\"space-between\":\"\"}},[_c('v-flex',[_c('p',{staticClass:\"title mb-0\"},[_vm._v(\"$\"+_vm._s(invoice.amount / 100))])]),_c('v-flex',[_c('p',{staticClass:\"title mb-0\"},[_vm._v(_vm._s(invoice.created))])]),_c('v-flex',[_c('p',{staticClass:\"title mb-0\"},[_vm._v(\"xxxx xxxx \"+_vm._s(invoice.source.last4))])])],1),_c('v-divider')],1)],1)}))],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-container grid-list-md>\n    <v-layout\n      column>\n      <v-flex\n        xs12\n        sm9\n        md5>\n        <v-card>\n          <v-card-title>\n            <p class=\"caption\">Your Plan</p>\n          </v-card-title>\n          <v-card-text>\n            <p class=\"title\">{{loggedInUser.stripe.plan}}</p>\n            <p class=\"caption\"> Active Users: {{activeUsers}} / {{headcount}} </p>\n          </v-card-text>\n          <v-card-actions>\n            <v-spacer/>\n            <v-btn\n              to=\"company.users\"\n              color=\"accent\">\n              Add Users\n            </v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-flex>\n      <v-flex\n        xs12\n        sm9\n        md5>\n        <v-card>\n          <v-card-title>\n            <p class=\"caption\">Payment Method</p>\n          </v-card-title>\n          <v-card-text class=\"mt-0\">\n            <p class=\"title\"> {{this.cardBrand}} Ending in {{this.cardLast4}} </p>\n          </v-card-text>\n          <v-card-actions>\n            <v-spacer/>\n            <v-btn flat @click=\"setPayInfo\">\n              Change Payment\n            </v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-flex>\n      <v-flex\n        xs12\n        sm9\n        md5>\n        <v-card>\n          <v-card-title>\n            <p class=\"caption\">Recent Payments</p>\n          </v-card-title>\n          <v-card-text>\n            <!-- ruby test -->\n            <v-list v-for=\"invoice in invoices\" :key=invoice.id>\n              <v-list-tile>\n                <v-layout\n                  row\n                  space-between>\n                  <v-flex>\n                    <p class=\"title mb-0\">${{invoice.amount / 100}}</p>\n                  </v-flex>\n                  <v-flex>\n                    <p class=\"title mb-0\">{{invoice.created}}</p>\n                  </v-flex>\n                  <v-flex>\n                    <p class=\"title mb-0\">xxxx xxxx {{invoice.source.last4}}</p>\n                  </v-flex>\n                </v-layout>\n                <v-divider/>\n              </v-list-tile>\n            </v-list>\n          </v-card-text>\n        </v-card>\n      </v-flex>\n  </v-layout></v-container>\n</template>\n<style lang=\"stylus\" scoped>\n  hr\n    margin: 10px 0\n\n</style>\n\n<script>\n// ruby test <\nimport { stripeOptions } from '@/constants';\nimport { mapState, mapMutations } from 'vuex';\nimport { get } from 'lodash';\nimport { mapGetters } from \"vuex\";\n\nlet planData = stripeOptions.planData;\n// ruby test >\n\nexport default {\n  name: 'CompanyBilling',\n  // ruby test <\n  components: {},\n\n  data (){\n    return {\n      cardBrand : '',\n      cardLast4 : '',\n      invoices : [],\n      activeUsers : 0,\n      headcount : 0,\n    };\n  },\n\n  computed: {\n    ...mapGetters(\"companies\", {\n      company: \"current\"\n    }),\n    ...mapGetters(\"auth\", [\"loggedInUser\"]),\n  },\n\n  mounted () {\n    this.getInvoices();\n  },\n\n  methods:{\n    ...mapMutations(\"snackbar\", {\n      showSnackbar: \"show\"\n    }),\n\n    setPayInfo() {\n      if(!this.loggedInUser.stripe) {\n        return;\n      }\n\n      if(this.loggedInUser.stripe.plan == 'Free'){\n        this.showSnackbar({color: \"error\" , message: \"Upgrade required.\"});\n        return;\n      }\n\n      this.$checkout.open({\n        name: 'Enjoy Incubie!',\n        panelLabel: \"Change Payment\",\n        currency: 'USD',\n        amount: 0,\n        token: (token) => {\n          let res = this.changePayment(planData.incubiePremium, token);\n        },\n        closed: () => {\n          console.log('ruby : stripe payment method changed...')\n        }\n      });\n    },\n\n    changePayment(specificPlan, token){\n      this.$dispatchAction({\n        type: this.$actionTypes.SET_PAYMENT_INFO,\n        entity: this.company._id,\n        payload: {\n          token: token,\n          userId: this.loggedInUser._id,\n          planData: specificPlan\n        }\n      }).then(res => {\n        if(res.data.success) {\n          let customer = res.data.customer;\n          let card = customer.sources.data[0];\n          this.cardBrand = card.brand;\n          this.cardLast4 = card.last4;\n        }\n      })\n    },\n\n    getInvoices() {\n      this.$dispatchAction({\n        type: this.$actionTypes.GET_PAYMENT_INFO,\n        entity: this.company._id,\n        payload: {\n          userId: this.loggedInUser._id,\n        }\n        }).then(res => {\n          console.log(\"ruby : getInvoices : res = \", res.data);\n          this.invoices = res.data.invoices;\n          if(this.invoices){\n            // convert data format\n            this.invoices.forEach(invoice => {\n              let timestamp = parseInt(invoice.created) * 1000;\n              let d = new Date(timestamp);\n              let month = '' + (d.getMonth() + 1);\n              let day = '' + d.getDate();\n              let year = d.getFullYear();\n              if (month.length < 2) month = '0' + month;\n              if (day.length < 2) day = '0' + day;\n              invoice.created = [year, month, day].join('-');\n              console.log(invoice.created);\n            });\n\n            this.cardBrand = res.data.customer.sources.data[0].brand;\n            this.cardLast4 = res.data.customer.sources.data[0].last4;\n            this.headcount = res.data.headcount;\n            this.activeUsers = res.data.activeUsers;\n          }\n        })\n    },\n\n    getActiveUserCount() {\n      \n    }\n\n  }\n  // ruby test >\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CompanyBilling.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CompanyBilling.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CompanyBilling.vue?vue&type=template&id=112bc8f2&scoped=true&\"\nimport script from \"./CompanyBilling.vue?vue&type=script&lang=js&\"\nexport * from \"./CompanyBilling.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CompanyBilling.vue?vue&type=style&index=0&id=112bc8f2&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"112bc8f2\",\n  null\n  \n)\n\ncomponent.options.__file = \"CompanyBilling.vue\"\nexport default component.exports"],"sourceRoot":""}